I"œ <p>æƒ³è¦çµæ´»åº”ç”¨å®ï¼Œç¦»ä¸å¼€<code class="language-plaintext highlighter-rouge">#</code>å’Œ<code class="language-plaintext highlighter-rouge">##</code>ã€‚</p>

<h3>â€</h3>
<p>åœ¨å­¦ä¹ <code class="language-plaintext highlighter-rouge">#</code>å’Œ<code class="language-plaintext highlighter-rouge">##</code>ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªå…³äº<code class="language-plaintext highlighter-rouge">"</code>çš„ä¾‹å­ï¼š</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p1</span> <span class="o">=</span> <span class="s">"Hello,"</span> <span class="s">"World!"</span><span class="p">;</span>     <span class="c1">// ä¸€ä¸ªç©ºæ ¼</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p2</span> <span class="o">=</span> <span class="s">"Hello,"</span>    <span class="s">"World!"</span><span class="p">;</span>  <span class="c1">// å¤šä¸ªç©ºæ ¼</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p3</span> <span class="o">=</span> <span class="s">"Hello,""World!"</span><span class="p">;</span>      <span class="c1">// æ²¡æœ‰ç©ºæ ¼</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p4</span> <span class="o">=</span> <span class="s">"Hello,World!"</span><span class="p">;</span>        <span class="c1">// ä¸€ä¸ªæ•´ä¸²</span>
    <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">p5</span> <span class="o">=</span> <span class="s">"Nihao,""Shijie!"</span><span class="p">;</span>  <span class="c1">// ä¸€ä¸ªä¸åŒçš„ä¸²</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"p1 = %s, strlen(p1) = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">p1</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"p2 = %s, strlen(p2) = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">p2</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"p3 = %s, strlen(p3) = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">p3</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"p4 = %s, strlen(p4) = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p4</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">p4</span><span class="p">));</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"p5 = %s, strlen(p5) = %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p5</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">p5</span><span class="p">));</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>è¾“å‡ºä¸ºï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p1 = Hello,World!, strlen(p1) = 12
p2 = Hello,World!, strlen(p2) = 12
p3 = Hello,World!, strlen(p3) = 12
p4 = Hello,World!, strlen(p4) = 12
p5 = Nihao,Shijie!, strlen(p5) = 13
</code></pre></div></div>

<p>æŸ¥çœ‹ PE æ–‡ä»¶çš„å¸¸é‡å­—ç¬¦ä¸²æ®µï¼Œå‘ç°ç»è¿‡ç¼–è¯‘å™¨ä¼˜åŒ–ååªå­˜åœ¨ä¸€ä¸ª<code class="language-plaintext highlighter-rouge">Hello,World!</code>ä¸²ã€‚</p>

<p><img src="/images/posts/cplusplus/staticstring_helloworld.png" alt="img" /></p>

<p>å³ p1ï¼Œp2ï¼Œp3ï¼Œp4 è¿™å››ç§å†™æ³•æ˜¯ç­‰ä»·çš„ï¼Œè¿™ä¸€ç‚¹ä½œä¸ºä¹‹åè§£é‡Š<code class="language-plaintext highlighter-rouge">#</code>ç”¨æ³•çš„å‰æã€‚</p>

<h3 id="å­—ç¬¦ä¸²åŒ–æ“ä½œ-">å­—ç¬¦ä¸²åŒ–æ“ä½œ (#)</h3>
<p>å½“ç”¨ä½œå­—ç¬¦ä¸²åŒ–æ“ä½œæ—¶ï¼Œ<code class="language-plaintext highlighter-rouge">#</code>çš„ä¸»è¦ä½œç”¨æ˜¯å°†å®å‚æ•°ä¸ç»æ‰©å±•åœ°è½¬æ¢æˆå­—ç¬¦ä¸²å¸¸é‡ã€‚
<strong>è¦ç‚¹ï¼š</strong></p>

<ul>
  <li>å®å®šä¹‰å‚æ•°çš„å·¦å³ä¸¤è¾¹çš„ç©ºæ ¼ä¼šè¢«å¿½ç•¥ï¼Œå‚æ•°çš„å„ä¸ª Token ä¹‹é—´çš„å¤šä¸ªç©ºæ ¼ä¼šè¢«è½¬æ¢æˆä¸€ä¸ªç©ºæ ¼ã€‚</li>
  <li>å®å®šä¹‰å‚æ•°ä¸­å«æœ‰éœ€è¦ç‰¹æ®Šå«ä¹‰å­—ç¬¦å¦‚<code class="language-plaintext highlighter-rouge">"</code>æˆ–<code class="language-plaintext highlighter-rouge">\</code>æ—¶ï¼Œå®ƒä»¬å‰é¢ä¼šè‡ªåŠ¨è¢«åŠ ä¸Šè½¬ä¹‰å­—ç¬¦<code class="language-plaintext highlighter-rouge">\</code>ã€‚</li>
</ul>

<p>è¿˜æ˜¯é€šè¿‡ MSDN ä¸Šçš„ä¾‹å­æ¥çœ‹çœ‹å®¹æ˜“æ‡‚ï¼š</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define F abc
#define B def
#define FB(arg) #arg
#define FB1(arg) FB(arg)
</span>
<span class="n">FB</span><span class="p">(</span><span class="n">F</span> <span class="n">B</span><span class="p">)</span>
<span class="n">FB1</span><span class="p">(</span><span class="n">F</span> <span class="n">B</span><span class="p">)</span>
</code></pre></div></div>

<p>åˆçœ‹åˆ°æ—¶æ¨æµ‹è¿™ä¸¤è¡Œé¢„ç¼–è¯‘å‡ºæ¥åæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯çœ‹äº†ä½¿ç”¨ gcc -E ç¼–è¯‘å‡ºæ¥ä»£ç ï¼Œè¿™æ‰ç†è§£äº† MSDN ä¸Šå¯¹ã€Œä¸ç»æ‰©å±•ã€æœ‰äº†æ›´æ·±åˆ»çš„ç†è§£ï¼Œå®é™…çš„é¢„ç¼–è¯‘åä»£ç ä¸ºï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"F B";
"abc def";
</code></pre></div></div>

<p>æ¨æµ‹å˜æ¢è¿‡ç¨‹åº”è¯¥å¦‚ä¸‹ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>FB(F B) --&gt; #F B --&gt;"F B"
FB1(F B) --&gt; FB1(abc def) --&gt; FB(abc def) --&gt; #abc def --&gt; "abc def"
</code></pre></div></div>

<h3 id="æ ‡è®°è¿æ¥æ“ä½œ-">æ ‡è®°è¿æ¥æ“ä½œ (##)</h3>
<p>å°†å¤šä¸ª Token è¿æ¥æˆä¸€ä¸ª Tokenã€‚
<strong>è¦ç‚¹ï¼š</strong></p>

<ul>
  <li>å®ƒä¸èƒ½æ˜¯å®å®šä¹‰ä¸­çš„ç¬¬ä¸€ä¸ªæˆ–æœ€åä¸€ä¸ª Tokenã€‚</li>
  <li>å‰åçš„ç©ºæ ¼å¯æœ‰å¯æ— ã€‚</li>
</ul>

<p>æ¥ç†è§£ä¸€ä¸‹ MSDN ä¸Šä¸¾çš„ä¾‹å­ï¼š</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;stdio.h&gt;
#define paster( n ) printf_s( "token" #n " = %d", token##n )
</span><span class="kt">int</span> <span class="n">token9</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
   <span class="n">paster</span><span class="p">(</span><span class="mi">9</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">paster(9);</code>çš„é¢„å¤„ç†æ­¥éª¤åº”è¯¥å¦‚ä¸‹ï¼š</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">paster(9);</code></li>
  <li><code class="language-plaintext highlighter-rouge">printf_s( "token" #9 " = %d", token##9 );</code></li>
  <li><code class="language-plaintext highlighter-rouge">printf_s( "token" "9" " = %d", token9 );</code></li>
  <li><code class="language-plaintext highlighter-rouge">printf_s( "token9 = %d", token9 );</code></li>
</ul>

<p>è¿™æ ·åº”è¯¥å°±å¾ˆå¥½ç†è§£äº†ã€‚</p>

<h3 id="å‚è€ƒ-msdn">å‚è€ƒ MSDN</h3>

<ul>
  <li>Stringizing Operator(#) : <a href="http://msdn.microsoft.com/EN-US/library/7e3a913x(v=VS.110,d=hv.2).aspx">http://msdn.microsoft.com/EN-US/library/7e3a913x(v=VS.110,d=hv.2).aspx</a></li>
  <li>Token-Pasting Operator(##) : <a href="http://msdn.microsoft.com/EN-US/library/09dwwt6y(v=VS.110,d=hv.2).aspx">http://msdn.microsoft.com/EN-US/library/09dwwt6y(v=VS.110,d=hv.2).aspx</a></li>
</ul>
:ET