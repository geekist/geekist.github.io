I"Q<h2 id="æ–‡ä»¶æ“ä½œ">æ–‡ä»¶æ“ä½œ</h2>

<h3 id="å¼•ç”¨æ‰“å¼€çš„å·¥ä½œç°¿">å¼•ç”¨æ‰“å¼€çš„å·¥ä½œç°¿</h3>

<p>ä½¿ç”¨ç´¢å¼•å·ï¼ˆä» 1 å¼€å§‹ï¼‰</p>

<pre><code class="language-vbnet">Workbooks(1)
</code></pre>

<p>ä½¿ç”¨å·¥ä½œç°¿åç§°</p>

<pre><code class="language-vbnet">Workbooks("1.xlsx")
</code></pre>

<h3 id="åˆ›å»ºä¸€ä¸ª-excel-å·¥ä½œç°¿å¯¹è±¡">åˆ›å»ºä¸€ä¸ª EXCEL å·¥ä½œç°¿å¯¹è±¡</h3>

<pre><code class="language-vbnet">Dim wd As Excel.Application
Dim wb As Workbook

Set wd = CreateObject("excel.application")
wd.Visible = True
Set wb = wd.Workbooks.Open(ThisWorkbook.Path &amp; "/test.xls")

' ...

wb.Close
wd.Quit
</code></pre>

<h3 id="æ‰“å¼€ä¿å­˜å…³é—­å·¥ä½œç°¿">æ‰“å¼€/ä¿å­˜/å…³é—­å·¥ä½œç°¿</h3>

<pre><code class="language-vbnet">Dim wb As Workbook

wb = Workbooks.Open(ThisWorkbook.Path &amp; "/test.xls")

' ...

wb.Save
wb.Close
</code></pre>

<p>å…³é—­æ‰€æœ‰å·¥ä½œç°¿</p>

<pre><code class="language-vbnet">Workbooks.close
</code></pre>

<p>å¦å­˜ä¸ºï¼ˆè‡ªåŠ¨æ‰“å¼€æ–°æ–‡ä»¶å…³é—­æºæ–‡ä»¶ï¼‰</p>

<pre><code class="language-vbnet">ThisWorkbook.SaveAs FileName:="D:\1.xls"
</code></pre>

<p>å¦å­˜ä¸ºï¼ˆä¿ç•™æºæ–‡ä»¶ä¸æ‰“å¼€æ–°æ–‡ä»¶ï¼‰</p>

<pre><code class="language-vbnet">ThisWorkbook.SaveCopyAs FileName:="D:\1.xls"
</code></pre>

<h3 id="æ‹·è´æ–‡ä»¶">æ‹·è´æ–‡ä»¶</h3>

<pre><code class="language-vbnet">oldfile = ThisWorkBook.Path &amp; "/old.xlsx"
newfile = ThisWorkBook.Path &amp; "/new.xlsx"
FileCopy oldfile, newfile
</code></pre>

<h3 id="åˆ é™¤æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶">åˆ é™¤æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</h3>

<pre><code class="language-vbnet">base = ThisWorkBook.Path &amp; "/æ–‡ä»¶å¤¹/"
pattern = base &amp; "*.*"
file = Dir(pattern, vbReadOnly)
While file &lt;&gt; ""
    Kill base &amp; file
    file = Dir
Wend
</code></pre>

<h3 id="åˆ›å»ºæ–‡ä»¶å¤¹">åˆ›å»ºæ–‡ä»¶å¤¹</h3>

<pre><code class="language-vbnet">MkDir(directory)
</code></pre>

<h3 id="åˆ¤æ–­æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨">åˆ¤æ–­æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨</h3>

<p>ä»¥ä¸‹ä¸ºä¸å­˜åœ¨å³åˆ›å»º</p>

<pre><code class="language-vbnet">If Dir(outputDir, 16) = Empty Then
    MkDir (outputDir)
End If
</code></pre>

<h3 id="åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨">åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</h3>

<p>æ–¹æ³• 1ï¼š</p>

<pre><code class="language-vbnet">Dim fileSystemObject As Object

Set fileSystemObject = CreateObject("Scripting.FileSystemObject")

If fileSystemObject.FileExists(&lt;filepath&gt;) = True Then
    MsgBox "æ–‡ä»¶å­˜åœ¨"
End If
</code></pre>

<p>æ–¹æ³• 2ï¼š</p>

<pre><code class="language-vbnet">Dim file As String

file = Dir("E:\MyPictures\Pic\logo.gif")

If file &lt;&gt; "" Then
    MsgBox  "æ–‡ä»¶å­˜åœ¨"
Endif
</code></pre>

<h2 id="æ ¼å¼æ“ä½œ">æ ¼å¼æ“ä½œ</h2>

<h3 id="è®¾ç½®è¾¹æ¡†ä¸è‡ªåŠ¨ç­›é€‰">è®¾ç½®è¾¹æ¡†ä¸è‡ªåŠ¨ç­›é€‰</h3>

<pre><code class="language-vbnet">Set Rng = MyWorkSheet.UsedRange
With Rng
    .Borders.LineStyle = xlContinuous
    .Borders.Weight = xlThin
    .AutoFilter
End With
</code></pre>

<h3 id="è·å–æˆ–è€…è®¾ç½®å•å…ƒæ ¼èƒŒæ™¯è‰²">è·å–æˆ–è€…è®¾ç½®å•å…ƒæ ¼èƒŒæ™¯è‰²</h3>

<pre><code class="language-vbnet">MyWorkSheet.Cells(i, j).Interior.ColorIndex
</code></pre>

<h3 id="è®©æŸè¡¨æ ¼é€‰ä¸­çš„å•å…ƒæ ¼å˜æˆæŒ‡å®šé¢œè‰²">è®©æŸè¡¨æ ¼é€‰ä¸­çš„å•å…ƒæ ¼å˜æˆæŒ‡å®šé¢œè‰²</h3>

<p>åœ¨ thisworkbook ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç æ®µï¼š</p>

<pre><code class="language-vbnet">Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)
    If ActiveSheet.Name = "yoursheet" Then
        ActiveSheet.UsedRange.Interior.ColorIndex = 0
        Target.Interior.ColorIndex = 6
    End If
End Sub
</code></pre>

<h3 id="åœ¨å•å…ƒæ ¼é‡Œå›è½¦--æ¢è¡Œ">åœ¨å•å…ƒæ ¼é‡Œå›è½¦ / æ¢è¡Œ</h3>

<p>è®¾ç½®å•å…ƒæ ¼ Value é‡Œä½¿ç”¨ <code class="language-plaintext highlighter-rouge">Chr(10)</code> å’Œ <code class="language-plaintext highlighter-rouge">Chr(13)</code>ï¼Œåˆ†åˆ«è¡¨ç¤ºå›è½¦ã€æ¢è¡Œã€‚</p>

<h3 id="éšè—è¡Œ">éšè—è¡Œ</h3>

<pre><code class="language-vbnet">MyWorkSheet.Rows(i).Hidden = True
</code></pre>

<h3 id="å•å…ƒæ ¼å†…å®¹ä¸ºçº¯æ–‡æœ¬">å•å…ƒæ ¼å†…å®¹ä¸ºçº¯æ–‡æœ¬</h3>

<pre><code class="language-vbnet">sheet.Cells(m, n).NumberFormatLocal = "@"
</code></pre>

<h2 id="é€‰æ‹©">é€‰æ‹©</h2>

<h3 id="å¼•ç”¨å•å…ƒæ ¼--åŒºåŸŸ">å¼•ç”¨å•å…ƒæ ¼ / åŒºåŸŸ</h3>

<pre><code class="language-vbnet">Range("A1") 'è¡¨ç¤º A1 å•å…ƒæ ¼
Range("A2:D1") 'è¡¨ç¤º A2 åˆ° D1 åŒºåŸŸ
Range("A2:D1")(3) 'è¡¨ç¤ºè¯¥åŒºåŸŸé‡Œçš„ç¬¬ä¸‰ä¸ªå•å…ƒæ ¼
Range("D" &amp; i) 'i ä¸ºå˜é‡
Range("D3:F4,G10") 'å¼•ç”¨å¤šä¸ªåŒºåŸŸ
Range("2:2") 'å¼•ç”¨ç¬¬äºŒè¡Œ
Range("2:12") 'å¼•ç”¨ç¬¬äºŒè¡Œåˆ°ç¬¬åäºŒè¡Œ
Range("D:A") 'å¼•ç”¨ç¬¬ A åˆ° D åˆ—
Rows(2) 'å¼•ç”¨ç¬¬äºŒè¡Œ
Rows("2:4") 'å¼•ç”¨ç¬¬äºŒåˆ°å››è¡Œ
Columns("B")
Columns("B:D")
Range(Clee1, Cell2) 'å·¦ä¸Šä¸å³ä¸‹
Range(Range1, Range2) 'å–æœ€å¤§èŒƒå›´
</code></pre>

<h3 id="é€‰ä¸­å•å…ƒæ ¼--åŒºåŸŸ">é€‰ä¸­å•å…ƒæ ¼ / åŒºåŸŸ</h3>

<pre><code class="language-vbnet">Range("1:1").Select 'é€‰ä¸­ç¬¬ä¸€è¡Œ
</code></pre>

<h3 id="è·å–å½“å‰é€‰ä¸­åŒºåŸŸ">è·å–å½“å‰é€‰ä¸­åŒºåŸŸ</h3>

<pre><code class="language-vbnet">MyWorkSheet.Application.Selection
</code></pre>

<h2 id="æ•°æ®ç»“æ„">æ•°æ®ç»“æ„</h2>

<h3 id="dictionary">Dictionary</h3>

<pre><code class="language-vbnet">Dim dict
Set dict = CreateObject("Scripting.Dictionary")

' æ–°å¢ï¼Œå„ç§ç±»å‹éƒ½å¯ä»¥ï¼ŒåŒ…æ‹¬ Dictionary
dict.Add "hello", "world"

' æ•°é‡
dict.Count

' åˆ é™¤
dict.Remove("hello")

' åˆ¤æ–­æ˜¯å¦å­˜åœ¨
dict.exists("hello")

' å–å€¼ï¼Œéœ€è¦å…ˆåˆ¤æ–­å­˜åœ¨å†å–
dict.Item("hello")

' ä¿®æ”¹ã€æ–°å¢
dict.Item("hello") = "world"

' å¾ªç¯
k = dict.Keys
v = dict.Items
For i = 0 to dict.count - 1
    key = k(i)
    value = v(i)
Next

' æ¸…ç©º
dict.RemoveAll
</code></pre>

<p>å‚è€ƒï¼š<a href="http://www.cnblogs.com/zhjh256/p/6428333.html">Excel vba map/dictionary</a></p>

<h2 id="è¯­è¨€åŸºç¡€">è¯­è¨€åŸºç¡€</h2>

<h3 id="string-to-integerdouble">String to Integerã€Double</h3>

<pre><code class="language-vbnet">CInt(MyWorkSheet.Cells(1,7))

CDbl(MyWorkSheet.Cells(1,7))
</code></pre>

<h3 id="å­—ç¬¦ä¸²åˆ†å‰²è·å–æ•°ç»„é•¿åº¦">å­—ç¬¦ä¸²åˆ†å‰²/è·å–æ•°ç»„é•¿åº¦</h3>

<pre><code class="language-vbnet">Dim arr() As String
arr() = Split(ws.Cells(a, b).Value, "-")
alen = UBound(arr) - LBound(arr) + 1
</code></pre>

<h3 id="åˆ¤æ–­å•å…ƒæ ¼æ˜¯å¦ä¸ºç©º">åˆ¤æ–­å•å…ƒæ ¼æ˜¯å¦ä¸ºç©º</h3>

<p>åˆ¤æ–­å•å…ƒæ ¼çš„ value æ˜¯å¦ä¸º â€œâ€œã€‚</p>

<h3 id="é€€å‡º">é€€å‡º</h3>

<p>ä¸»è¦ä½¿ç”¨ Exit è¡¨è¾¾å¼ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Exit { Do | For | Function | Property | Select | Sub | Try | While }
</code></pre></div></div>

<p>å‚è§ <a href="https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/exit-statement">Exit Statement (Visual Basic)</a></p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<ul>
  <li><a href="http://software-solutions-online.com/converting-data-types/">VBA Converting Data Types</a></li>
  <li><a href="http://blog.sina.com.cn/s/blog_6d5dcf100101bkhz.html##1">excel vbaåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</a></li>
</ul>
:ET